<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CookItUp! Home Page</title>
</head>

<body>
    <script src="..\header.js"></script>
    <nav>
        <article id="article">
            <section>
                <form>
                    <label for="name">Search for recipes: </label>
                    <input type="text" id="name">
                    <br/>
                    <button type="button" onclick="search()">Submit</button>
                </form>
            </section>
        </article>
    </nav>
    <script>
        function search() {
            console.log("here");
            let name = document.getElementById("name").value;
            let url = "/recipe/"+name+"/search";
            fetch(url).then(response => {

                return response.json();
            }).then(json => {
                let article = document.getElementById("article");
                let search = document.getElementById("search");
                if (search != null) {
                    article.removeChild(search);
                }
                search = document.createElement("div");
                search.id = "search";
                for (let i = 0; i < json.length; i++) {
                    let section = document.createElement("section");

                    //create the title
                    let link = document.createElement("a");
                    link.href = "/recipe/" + json[i].id + "/view.html";
                    let title = document.createElement("h2");
                    title.textContent = json[i].name;
                    link.appendChild(title);
                    section.appendChild(link);

                    //create the title for the ingredients
                    let ingredientsTitle = document.createElement("h3");
                    ingredientsTitle.textContent = "Ingredients";
                    section.appendChild(ingredientsTitle);
                    //create the list for the ingredients
                    let ingredientsList = document.createElement("ul");
                    let ingredients = json[i]["ingredients"];
                    for (let j = 0; j < ingredients.length; j++) {
                        let li = document.createElement("li");
                        li.textContent = ingredients[j].name;
                        ingredientsList.appendChild(li);
                    }
                    section.appendChild(ingredientsList);

                    //create the title for the steps
                    let stepsTitle = document.createElement("h3");
                    stepsTitle.textContent = "Steps";
                    section.appendChild(stepsTitle);
                    //create the list for the steps
                    let stepsList = document.createElement("ol");
                    let steps = json[i]["steps"];
                    for (let j = 0; j < steps.length; j++) {
                        let li = document.createElement("li");
                        li.textContent = steps[j].title;
                        stepsList.appendChild(li);
                    }
                    section.appendChild(stepsList);

                    search.appendChild(section);
                    search.appendChild(document.createElement("hr"));
                }
                article.appendChild(search);
            });
        }
    </script>
    <script src="..\footer.js"></script>
</body>
</html>