<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CookItUp! Sign Up</title>
</head>
<body>
    <script src="header.js"></script>
    <nav>
        <article>
            <selection id = "selection">
                <h2>Sign up</h2>
                <p>Name: <input id="name" type="text" name="name" /></p>
                <p>Password: <input id="password" type="password" name="password" /></p>
                <button onclick="SignUp()">Submit</button>
            </selection>
        </article>
    </nav>
    <script src="footer.js"></script>
    <script>
        function SignUp() {
            let nameUser = document.getElementById("name").value;
            let password = document.getElementById("password").value;
            let searchParams = "name="+nameUser+"&password="+password;

            let fetchOptions = {
                method: 'POST',
                headers: new Headers({
                    'Content-Type': 'application/x-www-form-urlencoded', // <-- Specifying the Content-Type
                }),
                body: searchParams
            }

            let url = "home/sign_up";
            fetch(url, fetchOptions).then( response => {
                let textPromise = response.text();
                textPromise.then(text => {
                    if(text != "") {
                        let errorMessage = document.getElementById("errorMessage");
                        if (errorMessage == null) {
                            errorMessage = document.createElement("p")
                            errorMessage.id = "errorMessage";
                            errorMessage.innerText = text;
                            document.getElementById("selection").appendChild(errorMessage);
                        }
                        else {
                            errorMessage.innerText = text;
                        }
                    }
                    else {
                        window.location.replace('/home.html');
                    }
                });
            });
        }
    </script>
</body>
</html>